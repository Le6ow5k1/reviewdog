name: Playground
on: [pull_request]
jobs:

  playground:
    name: Play!
    runs-on: ubuntu-latest
    steps:

    - name: Check PATH
      run: |
        echo $PATH

    - name: Check GitHub Event Json
      run: |
        cat $GITHUB_EVENT_PATH | jq .

    - name: Use Context Input
      env:
        CI_PULL_REQUEST: ${{ github.event.number }}
        CI_COMMIT: ${{ github.sha }}
        CI_REPO_OWNER: ${{ github.event.repository.owner.login }}
        CI_REPO_NAME: ${{ github.event.repository.name }}
        CI_REPOSITORY: ${{ github.repository }}
        CI_BRANCH: ${{ github.event.pull_request.head.ref }}
      run: |
        echo $CI_PULL_REQUEST
        echo $CI_COMMIT
        echo $CI_REPO_OWNER
        echo $CI_REPO_NAME
        echo $CI_REPOSITORY
        echo $CI_BRANCH

  reviewdog:
    name: reviewdog check
    runs-on: ubuntu-latest
    steps:

    - name: Set up Go 1.12
      uses: actions/setup-go@v1
      with:
        go-version: 1.12
      id: go

    - name: Check out code into the Go module directory
      uses: actions/checkout@v1

    - name: Install linters
      run: '( cd linters && go get golang.org/x/lint/golint )'

    - name: Setup reviewdog
      run: |
        curl -sfL https://raw.githubusercontent.com/reviewdog/reviewdog/master/install.sh| sh -s -- -b $(go env GOPATH)/bin

    - name: Run reviewdog
      env:
        CI_PULL_REQUEST: ${{ github.event.number }}
        CI_COMMIT: ${{ github.sha }}
        CI_REPO_OWNER: ${{ github.event.repository.owner.login }}
        CI_REPO_NAME: ${{ github.event.repository.name }}
        CI_REPOSITORY: ${{ github.repository }}
        CI_BRANCH: ${{ github.event.pull_request.head.ref }}
        REVIEWDOG_GITHUB_API_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        PATH=$(go env GOPATH):$PATH
        golint ./... | reviewdog -f=golint -name=golint-via-github-actions -reporter=github-pr-review
